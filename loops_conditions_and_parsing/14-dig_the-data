#!/usr/bin/env bash
# This script groups visitors by IP and HTTP status code from an Apache log file

# Check if the log file exists and is not empty
if [[ ! -f apache-access.log || ! -s apache-access.log ]]; then
    echo "Log file is empty."
    exit 0
fi

# Parse the log file, group by IP and HTTP status code, count occurrences, and sort
awk '{print $1, $9}' apache-access.log | \
awk 'NF {count[$1, $2]++} END {for (i in count) print count[i], i}' | \
sort -nr
