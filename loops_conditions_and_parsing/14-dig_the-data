#!/usr/bin/env bash
# This script groups visitors by IP and HTTP status code from an Apache log file

# Check if the log file exists and is not empty
if [[ ! -s apache-access.log ]]; then
    echo "Log file is empty."
    exit 0
fi

# Parse the log file, group by IP and HTTP status code, count occurrences, and sort
awk '{print $1, $9}' apache-access.log | \
awk '{count[$1, $2]++} END {for (ip_http in count) print count[ip_http], ip_http}' | \
sort -nr
